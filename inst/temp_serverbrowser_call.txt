#UI
popkinr::serverBrowserUI("comparison_browser")

# Server
run_browser_formatting <- function(id, text){
  # `id` is the path of the tree node
  is_nm_run <- is_nm_run_folder(id)
  if(is_nm_run) return(sprintf("<span style='color:red;'>%s</span>", text))

  has_archives <- (length(list.files(id, pattern = "\\.tar\\.gz$", ignore.case = TRUE)) > 0)
  if(has_archives) return(sprintf("<strong>%s</strong>", text))

  text
}

run_browser <- callModule(popkinr::serverBrowser, "run_browser",
                          root_directory = browsing_root,
                          initial_selection = user_initial_selection,
                          file_extensions = "tar.gz",
                          folder_shortcuts = reactive({
                            if(nrow(rv$previous_runs) > 0) return(dirname(rv$previous_runs$path))
                          }),
                          formatting_function = run_browser_formatting)
